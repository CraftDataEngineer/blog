<!doctype html>
<html lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Data Guru RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Data Guru Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Data Guru" href="/opensearch.xml"><title data-rh="true">Terraform - Concept &amp; Workflow | Data Guru</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.dataguru.fr/blog/2022/11/01/terraform-concepts-et-workflow"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="data, engineer"><meta data-rh="true" name="keywords" content="dataguru, data guru , Data guru"><meta data-rh="true" property="og:title" content="Terraform - Concept &amp; Workflow | Data Guru"><meta data-rh="true" name="description" content="Objectifs :"><meta data-rh="true" property="og:description" content="Objectifs :"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-11-11T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://www.dataguru.fr/blog/2022/11/01/terraform-concepts-et-workflow"><link data-rh="true" rel="alternate" href="https://www.dataguru.fr/blog/2022/11/01/terraform-concepts-et-workflow" hreflang="fr"><link data-rh="true" rel="alternate" href="https://www.dataguru.fr/blog/2022/11/01/terraform-concepts-et-workflow" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e9661612.css">
<link rel="preload" href="/assets/js/runtime~main.ad0685d2.js" as="script">
<link rel="preload" href="/assets/js/main.73cb1777.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Aller au contenu principal</a></div><div class="announcementBar_IbjG" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">Participez √† nos prochains webinaires pour vous formez gratuitement ! <a target="_blank" rel="noopener noreferrer" href="https://www.meetup.com/fr-FR/data-guru-meetup-group/">Meetup</a></div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Fermer"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav style="border-bottom:" class="navbar navbar--fixed-top navBarFont_uTjy"><div class="container navContainer_UNgl"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="buttonMenu_Q2Mu"><div id="title" class="buttonTitle_hShK"><strong>MENU</strong></div><div id="icon"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div></div></button><a class="navBarLogo_busP" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj" height="80" width="80"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU" height="80" width="80"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">ACCUEIL</a><a class="navbar__item navbar__link" href="/catalogue/">LES FORMATIONS</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">LE BLOG</a><a href="/RendezVous/"><button class="button button--outline button--warning navbarItem_Lgpx">Prendre rendez-vous</button></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Navigation article de blog r√©cent"><div class="sidebarItemTitle_uKok margin-bottom--md">Les posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2023/02/23/documenter-sa-base">Documenter sa base de donn√©e</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2023/02/16/loi-de-conway">Loi de Conway</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/2022/11/01/terraform-concepts-et-workflow">Terraform - Concept &amp; Workflow</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Terraform - Concept &amp; Workflow</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-11-11T00:00:00.000Z" itemprop="datePublished">11 novembre 2022</time> ¬∑ <!-- -->4 minutes de lecture</div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_mojV" id="objectifs-">Objectifs :<a class="hash-link" href="#objectifs-" title="Lien direct vers le titre">‚Äã</a></h2><ul><li>Comprendre les concepts : <code>Terraform core</code> &amp; <code>Terraform plugin</code></li><li>Connaitre les diff√©rents workflows de Terraform</li></ul><p><img loading="lazy" alt="img.png" src="/assets/images/terraform_orchestrateur-ad503d8eb2b76416b03d39b1917fe329.png" width="1005" height="516"></p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="rappels--101-terraform">Rappels : 101 Terraform<a class="hash-link" href="#rappels--101-terraform" title="Lien direct vers le titre">‚Äã</a></h2><p>Terraform est un <strong>projet open source</strong> cr√©√© en <strong>2014</strong> par <a href="https://www.hashicorp.com/" target="_blank" rel="noopener noreferrer">Hashicorp</a>.</p><p>A l&#x27;√©criture de ce blog, Terraform a :</p><ul><li><code>35K</code> ‚≠êÔ∏è</li><li>Plus de <code>30k commits</code></li><li>Plus de <code>1600 contributeurs</code></li></ul><p><img loading="lazy" alt="img.png" src="/assets/images/terraform_github-76aedb9cfc1b6c8bf686ab6db814208d.png" width="1538" height="755">
<em><a href="https://github.com/hashicorp/terraform" target="_blank" rel="noopener noreferrer">https://github.com/hashicorp/terraform</a></em></p><p><strong>Ce qu&#x27;on peut faire avec Terraform :</strong></p><ul><li>G√©rer des ressources d&#x27;infrastructure de plusieurs <strong>fournisseurs cloud</strong><ul><li>Cr√©er une infrastructure r√©seau sur AWS</li><li>D√©ployer un cluster Kubernetes sur GCP</li></ul></li><li>Int√©ragir avec des <strong>produits d&#x27;infrastructure</strong><ul><li>Ins√©rer des secrets dans un Vault </li><li>D√©ployer une application sur Heroku</li></ul></li><li>Configurer des <strong>services d‚Äôinfrastructure</strong><ul><li>Cr√©er un projet/groupe/utilisateur sur GitLab</li><li>Initialiser une base de donn√©es PostgreSQL (et ses utilisateurs)</li></ul></li></ul><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="les-concepts--terraform-core--terraform-plugin">Les concepts : Terraform Core &amp; Terraform Plugin<a class="hash-link" href="#les-concepts--terraform-core--terraform-plugin" title="Lien direct vers le titre">‚Äã</a></h2><p>Terraform a la capacit√© de se <strong>brancher</strong> avec de <strong>nombreux providers</strong> : <em>AWS, GCP, AZURE, ELASTIC...</em> <em>Mais le fonctionnement interne de terraform ne change pas entre 2 providers.</em></p><p>Pour cela, Terraform est compos√© de <strong>2 parties</strong> <em>(s√©par√©es par un contrat d&#x27;interface)</em> :</p><ul><li><p><strong>Terraform Core :</strong> Il s&#x27;agit du binaire Terraform qui communique avec les plugins pour g√©rer les ressources de l&#x27;infrastructure.
Il fournit une interface commune qui vous permet de tirer parti de nombreux fournisseurs
de Clouds, bases de donn√©es, services et solutions internes.</p></li><li><p><strong>Terraform Plugin :</strong> Il s&#x27;agit de binaires ex√©cutables √©crits en Go qui communiquent avec Terraform Core via une interface RPC. Chaque plugin expose une impl√©mentation pour un service sp√©cifique, tel que le fournisseur AWS ou le
fournisseur cloud-init. </p></li></ul><p><img loading="lazy" alt="img.png" src="/assets/images/terraform_core_plugin-82e1fa4e71a1a3b0541b55c32f2f0055.png" width="983" height="182"></p><p>Actuellement, Terraform ne supporte qu&#x27;un seul type de plugin appel√© <strong><a href="https://developer.hashicorp.com/terraform/language/providers" target="_blank" rel="noopener noreferrer">Providers</a></strong>.<br>
<!-- -->Vous pouvez retrouver la liste en suivant le lien : <a href="https://registry.terraform.io/browse/providers" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/browse/providers</a></p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Des plugins custom</h5></div><div class="admonition-content"><p>On peut √©galement d√©velopper nos propres providers, Terraform propose un tutoriel : <a href="https://developer.hashicorp.com/terraform/tutorials/providers-plugin-framework/providers-plugin-framework-provider" target="_blank" rel="noopener noreferrer">Implement a Provider with the Terraform Plugin Framework</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="cin√©matique-g√©n√©rale-de-terraform">Cin√©matique g√©n√©rale de Terraform<a class="hash-link" href="#cin√©matique-g√©n√©rale-de-terraform" title="Lien direct vers le titre">‚Äã</a></h2><ol><li>Le d√©veloppeur(se) üßëüèª‚Äçüíª <strong>d√©veloppe</strong> le code Terraform</li><li>Le d√©veloppeur(se) üßëüèª‚Äçüíª <strong>ex√©cute</strong> des commandes Terraform</li><li>Terraform lit la <strong>configuration</strong> (code) ainsi que le <strong>fichier d&#x27;√©tat</strong> **</li><li>Terraform cr√©e un <strong>plan d&#x27;ex√©cution</strong> : arbre de d√©pendances </li><li>Terraform communique avec les APIs du provider pour <strong>appliquer les changements</strong></li></ol><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Fichier d&#x27;√©tat</h5></div><div class="admonition-content"><p> ** <strong>Le fichier d&#x27;√©tat</strong> est utilis√© par Terraform pour faire correspondre les <strong>ressources du monde r√©el</strong> √† votre <strong>configuration</strong> et conserver la trace des m√©tadonn√©es.</p></div></div><p><img loading="lazy" alt="img.png" src="/assets/images/cin√©matique_terraform-9c69b0517494a55fb4cbbb7f3ebdea49.png" width="1609" height="562"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="les-workflows-terraform">Les workflows Terraform<a class="hash-link" href="#les-workflows-terraform" title="Lien direct vers le titre">‚Äã</a></h2><p>Dans cette section nous allons voir les diff√©rents workflow Terraform : </p><ul><li><code>Workflow standard</code></li><li><code>Workflow lors d&#x27;une cr√©ation d&#x27;infrastructure</code></li><li><code>Workflow lors d&#x27;une mise √† jour d&#x27;infrastructure</code></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="workflow-standard">Workflow standard<a class="hash-link" href="#workflow-standard" title="Lien direct vers le titre">‚Äã</a></h3><hr><blockquote><p>Pour mettre en place notre <strong><a href="https://en.wikipedia.org/wiki/Working_directory" target="_blank" rel="noopener noreferrer">working directory</a></strong> il faut lancer la commande suivante :</p><ul><li><code>terraform init</code> </li></ul><p>‚ö†Ô∏è A chaque ajout de nouveau <a href="https://developer.hashicorp.com/terraform/language/modules/syntax" target="_blank" rel="noopener noreferrer">module</a> ou de provider il faudra, re-lancer cette commande.</p></blockquote><p>Une fois l&#x27;initialisation faite, le worklow standard pour d√©velopper du Terraform peut se r√©sumer en <strong>3 √©tapes</strong> :</p><ol><li><code>terraform plan</code> : <strong>Afficher</strong> les changements requis par la configuration actuelle <em>(plan d&#x27;ex√©cution)</em></li><li><code>terraform apply</code> : <strong>Appliquer</strong> le plan d&#x27;ex√©cution sur l&#x27;infrastructure r√©elle.</li><li><code>terraform destroy</code> : <strong>Supprimer</strong> toute l&#x27;infrastructure cr√©e avec Terraform </li></ol><blockquote><p>üí° Une fois qu&#x27;on a d√©velopp√© notre code Terraform, on peut le <strong>v√©rifier</strong> avec la commande :
<code>terraform validate</code> avant m√™me de lancer la commande <code>terraform plan</code> pour avoir un feedback plus rapide.</p></blockquote><p><img loading="lazy" alt="img.png" src="/assets/images/standard_workflow-2756b41fb4686a55da2be880d9bf3b6f.png" width="1487" height="574"></p><p>Pour aller plus loin : <a href="https://developer.hashicorp.com/terraform/intro/core-workflow" target="_blank" rel="noopener noreferrer">The Core Terraform Workflow</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="workflow-lors-dune-cr√©ation-dinfrastructure">Workflow lors d&#x27;une cr√©ation d&#x27;infrastructure<a class="hash-link" href="#workflow-lors-dune-cr√©ation-dinfrastructure" title="Lien direct vers le titre">‚Äã</a></h3><hr><p>Pour la premi√®re ex√©cution de la commande <code>terraform apply</code> : </p><ul><li>Terraform cr√©e <strong>l&#x27;infrastructure</strong> d√©finie dans votre configuration (code terraform).</li><li>Terraform cr√©e le <strong>fichier d&#x27;√©tat</strong> : <code>tfstate</code>.  </li></ul><p><img loading="lazy" alt="img.png" src="/assets/images/workflow_creation-a8da6624918444e2c58e0710d9afb2f6.png" width="1560" height="446"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="workflow-lors-dune-mise-√†-jour-dinfrastructure">Workflow lors d&#x27;une mise √† jour d&#x27;infrastructure<a class="hash-link" href="#workflow-lors-dune-mise-√†-jour-dinfrastructure" title="Lien direct vers le titre">‚Äã</a></h3><hr><ol><li><code>R√©cup√©ration du tfstate</code> :  r√©cup√©rer le dernier √©tat mis √† jour par Terraform.</li><li><code>R√©cup√©ration des √©tats r√©els</code> : r√©cup√©rer les √©ventuels changements d&#x27;infrastructure, externe √† Terraform (modification √† la main).</li><li><code>Application des diff√©rences</code> : cr√©er un plan d&#x27;ex√©cution et appliquer ces changements sur l&#x27;infrastructure r√©elle.</li><li><code>Mise √† jour du tfstate</code> :  mettre √† jour le tfstate avec l&#x27;infrastructure actuelle.</li></ol><p><img loading="lazy" alt="img.png" src="/assets/images/workflow_mise_a_jour-f6c8f96afda787a9bf4426ce7ac13ca6.png" width="1392" height="525"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Lien direct vers le titre">‚Äã</a></h2><p>Pour aller plus loin, dans le prochain article nous expliquerons en d√©tail le <strong>fichier d&#x27;√©tat</strong>.    </p><p>Et pour ceux qui souhaitent creuser les notions <code>Terraform Core</code> et <code>Terraform Plugin</code> on vous recommande la vid√©o :
<a href="https://www.youtube.com/watch?v=oNHABU-8xfs&amp;t=400s" target="_blank" rel="noopener noreferrer">Comment d√©velopper votre propre plugin Terraform ?</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagination des articles du blog"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2023/02/16/loi-de-conway"><div class="pagination-nav__sublabel">Article plus r√©cent</div><div class="pagination-nav__label">Loi de Conway</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objectifs-" class="table-of-contents__link toc-highlight">Objectifs :</a></li><li><a href="#rappels--101-terraform" class="table-of-contents__link toc-highlight">Rappels : 101 Terraform</a></li><li><a href="#les-concepts--terraform-core--terraform-plugin" class="table-of-contents__link toc-highlight">Les concepts : Terraform Core &amp; Terraform Plugin</a></li><li><a href="#cin√©matique-g√©n√©rale-de-terraform" class="table-of-contents__link toc-highlight">Cin√©matique g√©n√©rale de Terraform</a></li><li><a href="#les-workflows-terraform" class="table-of-contents__link toc-highlight">Les workflows Terraform</a><ul><li><a href="#workflow-standard" class="table-of-contents__link toc-highlight">Workflow standard</a></li><li><a href="#workflow-lors-dune-cr√©ation-dinfrastructure" class="table-of-contents__link toc-highlight">Workflow lors d&#39;une cr√©ation d&#39;infrastructure</a></li><li><a href="#workflow-lors-dune-mise-√†-jour-dinfrastructure" class="table-of-contents__link toc-highlight">Workflow lors d&#39;une mise √† jour d&#39;infrastructure</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footerDark_btIG"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><span class="footer__link-item"> <a href="https://www.facebook.com/DataGuru-108335435294231" target="_blank" rel="noreferrer noopener" aria-label="DataGuru Facebook">
                      <img src="https://upload.wikimedia.org/wikipedia/en/thumb/0/04/Facebook_f_logo_%282021%29.svg/640px-Facebook_f_logo_%282021%29.svg.png" alt="facebook" width="25px" height="2px">
                    </a> </span><span class="footer__link-separator">¬∑</span><span class="footer__link-item">
                    <a href="https://www.linkedin.com/company/dataguru" target="_blank" rel="noreferrer noopener" aria-label="DataGuru Linkedin">
                      <img src="https://media-exp1.licdn.com/dms/image/C560BAQHaVYd13rRz3A/company-logo_200_200/0/1638831589865?e=2147483647&v=beta&t=Zq1zixRFUNMSm2Ldgu_hcJAYTL1gWG3VHKXO4kf9lDQ" alt="linkedin" width="25px" height="2px">
                    </a>
                  </span><span class="footer__link-separator">¬∑</span><a class="footer__link-item" href="/quisommesnous">Qui sommes-nous ?</a></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/footer/qce.png" alt="Qualiopi" class="themedImage_W2Cr themedImage--light_TfLj" width="400" height="400"><img src="/img/footer/qce.png" alt="Qualiopi" class="themedImage_W2Cr themedImage--dark_oUvU" width="400" height="400"></div><div class="footer__copyright">Copyright ¬© 2023 Data Guru, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ad0685d2.js"></script>
<script src="/assets/js/main.73cb1777.js"></script>
</body>
</html>